import React from "react";
import { describe, test, expect, vi } from "vitest";
import { render } from "./test-utils";
import { screen } from "@testing-library/react";
import App from "../../App";
import { toast } from "react-toastify";
import StockView from "../StockView";
import Stock from "../Stock";

vi.mock(<Stock />, () => () => <div data-testid="mock-stock">Mock Stock</div>);

test("checks if 'Navigating the Stock Market' is rendered", () => {
  render(<App />);
});

describe("StockView Tests", () => {
  test("test stock page", () => {
    const preloadedState = {
      stock: {
        data: {
          meta: {
            symbol: "TSLA",
            interval: "5min",
            currency: "USD",
            exchange_timezone: "America/New_York",
            exchange: "NASDAQ",
            mic_code: "XNGS",
            type: "Common Stock",
          },
          values: [
            {
              datetime: "2024-01-29 15:25:00",
              open: "190.94141",
              high: "191.00000",
              low: "190.73000",
              close: "190.76500",
              volume: "451106",
            },
            {
              datetime: "2024-01-29 15:20:00",
              open: "190.28000",
              high: "190.99001",
              low: "190.16000",
              close: "190.94901",
              volume: "1323660",
            },
            {
              datetime: "2024-01-29 15:15:00",
              open: "189.98151",
              high: "190.33000",
              low: "189.71320",
              close: "190.28500",
              volume: "1072953",
            },
            {
              datetime: "2024-01-29 15:10:00",
              open: "190.07001",
              high: "190.15990",
              low: "189.80000",
              close: "189.98849",
              volume: "1017107",
            },
            {
              datetime: "2024-01-29 15:05:00",
              open: "189.76990",
              high: "190.30000",
              low: "189.60001",
              close: "190.05000",
              volume: "1450540",
            },
            {
              datetime: "2024-01-29 15:00:00",
              open: "188.70000",
              high: "189.82001",
              low: "188.67500",
              close: "189.75500",
              volume: "1530428",
            },
            {
              datetime: "2024-01-29 14:55:00",
              open: "188.45010",
              high: "188.77000",
              low: "188.36000",
              close: "188.69000",
              volume: "786688",
            },
            {
              datetime: "2024-01-29 14:50:00",
              open: "188.44000",
              high: "188.59000",
              low: "188.28999",
              close: "188.45200",
              volume: "680687",
            },
            {
              datetime: "2024-01-29 14:45:00",
              open: "188.96500",
              high: "188.97710",
              low: "188.42999",
              close: "188.43520",
              volume: "850865",
            },
            {
              datetime: "2024-01-29 14:40:00",
              open: "189.07990",
              high: "189.22000",
              low: "188.91000",
              close: "188.96500",
              volume: "697964",
            },
            {
              datetime: "2024-01-29 14:35:00",
              open: "189.32990",
              high: "189.39999",
              low: "188.92000",
              close: "189.06940",
              volume: "707763",
            },
            {
              datetime: "2024-01-29 14:30:00",
              open: "189.03999",
              high: "189.41000",
              low: "188.91000",
              close: "189.31990",
              volume: "811339",
            },
            {
              datetime: "2024-01-29 14:25:00",
              open: "189.19910",
              high: "189.22990",
              low: "188.85001",
              close: "189.03230",
              volume: "801913",
            },
            {
              datetime: "2024-01-29 14:20:00",
              open: "189.05881",
              high: "189.48911",
              low: "189.03011",
              close: "189.19000",
              volume: "945154",
            },
            {
              datetime: "2024-01-29 14:15:00",
              open: "189.18990",
              high: "189.24001",
              low: "188.97000",
              close: "189.07001",
              volume: "661314",
            },
            {
              datetime: "2024-01-29 14:10:00",
              open: "188.84010",
              high: "189.19000",
              low: "188.78000",
              close: "189.17999",
              volume: "755364",
            },
            {
              datetime: "2024-01-29 14:05:00",
              open: "188.87500",
              high: "188.89999",
              low: "188.64900",
              close: "188.85930",
              volume: "652670",
            },
            {
              datetime: "2024-01-29 14:00:00",
              open: "188.58009",
              high: "189.07001",
              low: "188.32001",
              close: "188.87900",
              volume: "941102",
            },
            {
              datetime: "2024-01-29 13:55:00",
              open: "188.36501",
              high: "188.60001",
              low: "188.25999",
              close: "188.59750",
              volume: "560521",
            },
            {
              datetime: "2024-01-29 13:50:00",
              open: "188.07550",
              high: "188.60001",
              low: "188.03000",
              close: "188.35899",
              volume: "863061",
            },
            {
              datetime: "2024-01-29 13:45:00",
              open: "188.12000",
              high: "188.21471",
              low: "188.03000",
              close: "188.06200",
              volume: "506121",
            },
            {
              datetime: "2024-01-29 13:40:00",
              open: "187.89650",
              high: "188.27000",
              low: "187.81000",
              close: "188.12090",
              volume: "807336",
            },
            {
              datetime: "2024-01-29 13:35:00",
              open: "187.84990",
              high: "188.06000",
              low: "187.55000",
              close: "187.89999",
              volume: "819937",
            },
            {
              datetime: "2024-01-29 13:30:00",
              open: "187.44000",
              high: "187.89000",
              low: "187.39000",
              close: "187.85150",
              volume: "709162",
            },
            {
              datetime: "2024-01-29 13:25:00",
              open: "187.53999",
              high: "187.78000",
              low: "187.20000",
              close: "187.42430",
              volume: "1059291",
            },
            {
              datetime: "2024-01-29 13:20:00",
              open: "187.77000",
              high: "187.80000",
              low: "187.32001",
              close: "187.51939",
              volume: "1047900",
            },
            {
              datetime: "2024-01-29 13:15:00",
              open: "187.74879",
              high: "188.07001",
              low: "187.58000",
              close: "187.77000",
              volume: "851772",
            },
            {
              datetime: "2024-01-29 13:10:00",
              open: "187.62041",
              high: "187.92000",
              low: "187.40010",
              close: "187.75090",
              volume: "1066379",
            },
            {
              datetime: "2024-01-29 13:05:00",
              open: "187.83560",
              high: "187.98000",
              low: "187.60001",
              close: "187.61560",
              volume: "873429",
            },
            {
              datetime: "2024-01-29 13:00:00",
              open: "188.41000",
              high: "188.58000",
              low: "187.75000",
              close: "187.82111",
              volume: "956674",
            },
            {
              datetime: "2024-01-29 12:55:00",
              open: "187.96001",
              high: "188.46989",
              low: "187.95000",
              close: "188.39720",
              volume: "933290",
            },
            {
              datetime: "2024-01-29 12:50:00",
              open: "187.94991",
              high: "188.19000",
              low: "187.75011",
              close: "187.97000",
              volume: "830419",
            },
            {
              datetime: "2024-01-29 12:45:00",
              open: "188.18671",
              high: "188.22121",
              low: "187.66010",
              close: "187.94000",
              volume: "980002",
            },
            {
              datetime: "2024-01-29 12:40:00",
              open: "188.39000",
              high: "188.64999",
              low: "188.00000",
              close: "188.18660",
              volume: "978498",
            },
            {
              datetime: "2024-01-29 12:35:00",
              open: "188.35400",
              high: "188.97000",
              low: "188.25000",
              close: "188.39110",
              volume: "1407166",
            },
            {
              datetime: "2024-01-29 12:30:00",
              open: "187.66229",
              high: "188.37000",
              low: "187.66229",
              close: "188.35561",
              volume: "1186848",
            },
            {
              datetime: "2024-01-29 12:25:00",
              open: "188.45930",
              high: "188.45930",
              low: "187.62000",
              close: "187.67000",
              volume: "1379937",
            },
            {
              datetime: "2024-01-29 12:20:00",
              open: "188.29910",
              high: "188.59000",
              low: "188.05830",
              close: "188.45000",
              volume: "1297179",
            },
            {
              datetime: "2024-01-29 12:15:00",
              open: "188.38901",
              high: "188.63989",
              low: "187.92999",
              close: "188.29350",
              volume: "1486984",
            },
            {
              datetime: "2024-01-29 12:10:00",
              open: "188.58949",
              high: "188.59000",
              low: "188.37000",
              close: "188.38000",
              volume: "798208",
            },
            {
              datetime: "2024-01-29 12:05:00",
              open: "188.92500",
              high: "188.96989",
              low: "188.53000",
              close: "188.58990",
              volume: "1127074",
            },
            {
              datetime: "2024-01-29 12:00:00",
              open: "189.42740",
              high: "189.45000",
              low: "188.77000",
              close: "188.92000",
              volume: "1226086",
            },
            {
              datetime: "2024-01-29 11:55:00",
              open: "189.01019",
              high: "189.69000",
              low: "188.82001",
              close: "189.38000",
              volume: "1573947",
            },
            {
              datetime: "2024-01-29 11:50:00",
              open: "189.03011",
              high: "189.06000",
              low: "188.62000",
              close: "189.00011",
              volume: "1489077",
            },
            {
              datetime: "2024-01-29 11:45:00",
              open: "189.30499",
              high: "189.58900",
              low: "188.88000",
              close: "189.04350",
              volume: "1597354",
            },
            {
              datetime: "2024-01-29 11:40:00",
              open: "189.63499",
              high: "189.63499",
              low: "189.10001",
              close: "189.29900",
              volume: "1634181",
            },
            {
              datetime: "2024-01-29 11:35:00",
              open: "189.96040",
              high: "190.14999",
              low: "189.59340",
              close: "189.63499",
              volume: "1581742",
            },
            {
              datetime: "2024-01-29 11:30:00",
              open: "189.89000",
              high: "190.59000",
              low: "189.89000",
              close: "189.98199",
              volume: "2298914",
            },
            {
              datetime: "2024-01-29 11:25:00",
              open: "190.57899",
              high: "190.89999",
              low: "189.81000",
              close: "189.86501",
              volume: "2866366",
            },
            {
              datetime: "2024-01-29 11:20:00",
              open: "189.54649",
              high: "190.59000",
              low: "189.42000",
              close: "190.58051",
              volume: "3160879",
            },
            {
              datetime: "2024-01-29 11:15:00",
              open: "189.73010",
              high: "189.74001",
              low: "189.26010",
              close: "189.53410",
              volume: "1715082",
            },
            {
              datetime: "2024-01-29 11:10:00",
              open: "189.30890",
              high: "189.81000",
              low: "189.23000",
              close: "189.74001",
              volume: "2674540",
            },
            {
              datetime: "2024-01-29 11:05:00",
              open: "188.21010",
              high: "189.32491",
              low: "188.19890",
              close: "189.32491",
              volume: "2550573",
            },
            {
              datetime: "2024-01-29 11:00:00",
              open: "187.27000",
              high: "188.39000",
              low: "187.20000",
              close: "188.22000",
              volume: "1980772",
            },
            {
              datetime: "2024-01-29 10:55:00",
              open: "187.14500",
              high: "187.64000",
              low: "186.96001",
              close: "187.28999",
              volume: "1545246",
            },
            {
              datetime: "2024-01-29 10:50:00",
              open: "187.87000",
              high: "188.11000",
              low: "187.07001",
              close: "187.15491",
              volume: "1791758",
            },
            {
              datetime: "2024-01-29 10:45:00",
              open: "187.88350",
              high: "188.42000",
              low: "187.50999",
              close: "187.88660",
              volume: "2748701",
            },
            {
              datetime: "2024-01-29 10:40:00",
              open: "187.03740",
              high: "187.90990",
              low: "187.00000",
              close: "187.88240",
              volume: "3525408",
            },
            {
              datetime: "2024-01-29 10:35:00",
              open: "185.45000",
              high: "187.37000",
              low: "185.45000",
              close: "187.03740",
              volume: "2642606",
            },
            {
              datetime: "2024-01-29 10:30:00",
              open: "185.27000",
              high: "185.60001",
              low: "185.00999",
              close: "185.47000",
              volume: "1375752",
            },
            {
              datetime: "2024-01-29 10:25:00",
              open: "184.65480",
              high: "185.42000",
              low: "184.48000",
              close: "185.28000",
              volume: "1361612",
            },
            {
              datetime: "2024-01-29 10:20:00",
              open: "185.28000",
              high: "185.44000",
              low: "184.52000",
              close: "184.65480",
              volume: "1534834",
            },
            {
              datetime: "2024-01-29 10:15:00",
              open: "185.42999",
              high: "185.48000",
              low: "184.86000",
              close: "185.25999",
              volume: "1647688",
            },
            {
              datetime: "2024-01-29 10:10:00",
              open: "185.25301",
              high: "186.16991",
              low: "185.12000",
              close: "185.44501",
              volume: "1955886",
            },
            {
              datetime: "2024-01-29 10:05:00",
              open: "184.07190",
              high: "185.75000",
              low: "184.02850",
              close: "185.27890",
              volume: "2188061",
            },
            {
              datetime: "2024-01-29 10:00:00",
              open: "184.08501",
              high: "184.88000",
              low: "183.73700",
              close: "184.04700",
              volume: "1903750",
            },
            {
              datetime: "2024-01-29 09:55:00",
              open: "185.00000",
              high: "185.10001",
              low: "183.67000",
              close: "184.07001",
              volume: "2120855",
            },
            {
              datetime: "2024-01-29 09:50:00",
              open: "184.91409",
              high: "185.28999",
              low: "184.02000",
              close: "185.00000",
              volume: "2388791",
            },
            {
              datetime: "2024-01-29 09:45:00",
              open: "184.95000",
              high: "185.03000",
              low: "184.50000",
              close: "184.91000",
              volume: "2197654",
            },
            {
              datetime: "2024-01-29 09:40:00",
              open: "186.62500",
              high: "186.70000",
              low: "184.77000",
              close: "184.93520",
              volume: "3181086",
            },
            {
              datetime: "2024-01-29 09:35:00",
              open: "185.55000",
              high: "186.88000",
              low: "184.39999",
              close: "186.63570",
              volume: "3451542",
            },
            {
              datetime: "2024-01-29 09:30:00",
              open: "185.66000",
              high: "186.20000",
              low: "184.58121",
              close: "185.55370",
              volume: "6257631",
            },
          ],
          status: "ok",
        },
        loading: false,
        error: null,
      },
      menu: {
        isDarkModeActive: false, // or any other initial state required for menu
      },
    };
    render(<StockView toast={toast} />, {
      preloadedState,
      initialEntries: ["/stock/TSLA/NASDAQ"],
    });

    expect(screen.getByTestId("stock-view-default")).toBeInTheDocument();
  });
});
